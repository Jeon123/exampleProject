<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  data-layout-decorate="~{layout/default}"
	  >
<head>
  <script type="text/javascript" src="./file/ckeditor/ckeditor.js"></script>
  <script type="text/javascript">
		function backPage(num) {
			window.history.go(-1);
	  	}
		
	    $(window).on("load", function(){
		    CKEDITOR.replace('content');
	    });
	    
		function FormSubmit(f) { 
			CKEDITOR.instances.content.updateElement(); 
			if(f.content.value == "") { 
				alert("내용을 입력해 주세요."); 
				return false; 
			} 
			alert(f.content.value); 
			// 전송은 하지 않습니다. 
			return false;
		}
	</script>
	<script type="application/javascript">
		$(document).ready(function(){
			$('#insertForm').submit(function(event){
				CKEDITOR.instances.content.updateElement();
				var freeBoard = {
					category: $('#category').val(),
					title: $('#title').val(),
					content: $('#content').val(),
					writer: $('#writer').val()
				}
				event.preventDefault();
				if(confirm("등록 하시겠습니까?") == true){
					$.ajax({
						url: '/boardWriteRequest',
						type: 'POST',
						dataType: 'json',
						contentType : "application/json; charset=UTF-8",
						data: JSON.stringify(freeBoard),
						success: function(){
							alert("등록 완료");
							location.href="/";
						},
						error: function(){
							alert("에러 발생");
							location.href="/";
						}
					})
				}
			})	
		})
	</script>
</head>

  <div layout:fragment="content" class="col-sm-10 text-left"> 
    <h4>FreeBoard</h4>
    <br><br>
    <form id="insertForm">
    	<select id="category">
    	    <option value="" selected disabled hidden>==카테고리 선택==</option>
    		<option value="1">1</option>
    		<option value="2">2</option>
    		<option value="3">3</option>
    		<option value="4">4</option>
    		<option value="5">5</option>
    	</select>
    	<input type="text" placeholder="글 제목" id="title">
    	<br><br>
    	<textarea placeholder="글 내용" id="content"></textarea>
    	<br><br>
    	<input type="hidden" th:value="${session.loginUser.getUsername()}" id="writer">
    	<input type="submit" value="글쓰기">
    	<input type="button" th:onclick="|javascript:backPage()|" value="취소">
    </form>
  </div>

</html>
